<!DOCTYPE html>
<html>
<head>
    <meta charset=utf-8>
    <title>Paper Marbling</title>
    <link rel="stylesheet" href="css/style.css"/>
    <link rel="stylesheet" href="css/help.css">
    <script src="js/renderer/curve_renderer.js"></script>
    <script src="js/renderer/svg_renderer.js"></script>
    <script src="js/operations/color_operations.js"></script>
    <script src="js/operations/inkdrop.js"></script>
    <script src="js/operations/linetine.js"></script>
    <script src="js/operations/circularlinetine.js"></script>
    <script src="js/operations/wavylinetine.js"></script>
    <script src="js/operations/vortex.js"></script>
    <script src="js/ui/ui.js"></script>
    <script src="js/ui/tools.js"></script>
    <script src="js/ui/panes/modal.js"></script>
    <script src="js/ui/panes/notification.js"></script>
    <script src="js/ui/panes/colorpane.js"></script>
    <script src="js/ui/panes/toolspane.js"></script>
    <script src="js/ui/panes/scriptingpane.js"></script>
    <script src="js/ui/keyboard.js"></script>
    <script src="js/ui/cursor/cursor_overlay.js"></script>
    <script src="js/ui/cursor/cursor_renderer.js"></script>
    <script src="js/ui/cursor/function_renderer.js"></script>
    <script src="js/ui/cursor/dynamic_radius_renderer.js"></script>
    <script src="js/ui/cursor/tine_renderer.js"></script>
    <script src="js/ui/vector_field_overlay.js"></script>
    <script src="js/ui/help_overlay.js"></script>
    <script src="js/models/color.js"></script>
    <script src="js/models/vector.js"></script>
    <script src="js/models/matrix.js"></script>
    <script src="js/models/vectorfield.js"></script>
    <script src="js/drawing_utilities.js"></script>
    <script src="js/parse_query_string.js"></script>
    <script src="js/scripting/user_program.js"></script>
    <script src="js/scripting/example_scripts.js"></script>

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.21.0/codemirror.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.21.0/theme/solarized.min.css">


</head>
<body>
<div id="workspace">

</div>

<div class="modal-container" style="display:none;">
    <div id="operations-input" class="marbling-pane center-pane">
        <ul class="toolbar">
            <li class="close-button tool">Close</li>
            <li class="get-url-button tool">Get URL</li>
            <li class="run-button tool">Run</li>
        </ul>
        <div class="input-container"></div>
    </div>
</div>

<div id="marbling-colors" class="marbling-pane">
    <ul class="toolbar">
        <input type="color" class="color-picker" value="#FFFFFF">
        <li class="swatch-0"></li>
        <li class="swatch-1"></li>
        <li class="swatch-2"></li>
        <li class="swatch-3"></li>
        <li class="swatch-4"></li>
        <li class="next-color-set">-></li>
    </ul>
</div>
<div id="marbling-tools" class="marbling-pane">
    <ul class="toolbar">
        <li class="drop-tool tool" title="Ink drop">Drop</li>
        <li class="spatter-tool tool" title="Spatter">Spatter</li>
        <li class="tine-tool tool" title="Tine line">Line</li>
        <li class="wavy-tine-tool tool" title="Wavy ">Wavy</li>
        <li class="circular-tine-tool tool" title="Circular tine-line">Circular</li>
        <li class="vortex-tool tool" title="Vortex">Vortex</li>
        <li class="reset">Reset</li>
    </ul>
</div>

<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.21.0/codemirror.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.21.0/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.3.6/svg.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>

<script>
    let renderer = null;
    addEventListener('load', function () {
        let marblingWorkspace = document.getElementById("workspace");
        let toolsPane = document.getElementById("marbling-tools");
        let colorsPane = document.getElementById("marbling-colors");
        let operationsInput = document.getElementById("operations-input");
        let ui = new MarblingUI(marblingWorkspace, toolsPane, colorsPane, operationsInput);
        renderer = new InteractiveCurveRenderer(marblingWorkspace);
        ui.delegate = renderer;
        renderer.setSize(window.innerWidth, window.innerHeight);
        ui.size = new Vec2(window.innerWidth, window.innerHeight);

        window.onresize = function (event) {
            renderer.setSize(window.innerWidth, window.innerHeight);
            ui.size = new Vec2(window.innerWidth, window.innerHeight);
        };

        const parameter = getParameterByName("p");
        if (parameter != null && confirm("Execute passed in program?")) {
            const decompressed = LZString.decompressFromEncodedURIComponent(parameter);
            const program = new UserProgram(decompressed);
            renderer.applyOperations(program.execute(new Vec2(window.innerWidth, window.innerHeight)));
        }

    });
</script>


</body>
</html>